(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/coper-post/coper-post"],{"09db":function(e,t,n){"use strict";n.r(t);var o=n("d8f9"),r=n("a92a");for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);n("d924");var i=n("828b"),u=Object(i["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=u.exports},"57e4":function(e,t,n){},5844:function(e,t,n){"use strict";(function(e,t){var o=n("47a9");n("f891"),n("861b");o(n("3240"));var r=o(n("09db"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},a92a:function(e,t,n){"use strict";n.r(t);var o=n("ddbb"),r=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=r.a},d8f9:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var o={uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-icon/u-icon")]).then(n.bind(null,"899d"))},uButton:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-button/u-button")]).then(n.bind(null,"6181"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,"06be"))},uTextarea:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-textarea/u-textarea")]).then(n.bind(null,"1b45"))},uUpload:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-upload/u-upload")]).then(n.bind(null,"92c5"))}},r=function(){var e=this.$createElement;this._self._c},a=[]},d924:function(e,t,n){"use strict";var o=n("57e4"),r=n.n(o);r.a},ddbb:function(e,t,n){"use strict";(function(e,o){var r=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("7eb4")),i=r(n("7ca3")),u=r(n("ee10"));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={data:function(){return{picurls:[],fileList1:[],views:["项目投融资","成果落地推广","科研合作","广告需求"],activeIndex:null,formData:{head:"",detail:"",situation:"outer",type:-1,type_name:""}}},methods:{deletePic:function(e){this["fileList".concat(e.name)].splice(e.index,1)},afterRead:function(e){var t=this;return(0,u.default)(a.default.mark((function n(){var o,r,i,u,c,l;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:o=[].concat(e.file),t["fileList".concat(e.name)].length,o.map((function(n){t["fileList".concat(e.name)].push(s(s({},n),{},{status:"uploading",message:"上传中"}))})),r=0;case 4:if(!(r<o.length)){n.next=22;break}return i=o[r],n.prev=6,n.next=9,t.uploadToUniCloud(i.url);case 9:u=n.sent,c=t.fileList1.length-1,t.fileList1.splice(c,1,s(s({},i),{},{status:"success",message:"",url:u.fileID})),n.next=19;break;case 14:n.prev=14,n.t0=n["catch"](6),l=t.fileList1.length-1,t.fileList1.splice(l,1,s(s({},i),{},{status:"failed",message:"上传失败"})),console.error("上传失败:",n.t0);case 19:r++,n.next=4;break;case 22:case"end":return n.stop()}}),n,null,[[6,14]])})))()},uploadToUniCloud:function(t){var n=this;return new Promise((function(o,r){e.uploadFile({filePath:t,cloudPath:"images/".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2),".jpg"),success:function(e){o(e),console.log("res_pic",e),n.picurls.push(e.fileID)},fail:function(e){r(e)}})}))},uploadSuccess:function(e){console.log(e),this.picurls=e.tempFilePaths},change:function(e){console.log(e)},setActive:function(e){this.activeIndex=e,this.formData.type_name=this.views[e],this.formData.type=e,console.log(this.formData.type)},validateForm:function(){return this.formData.head.trim()?!!this.formData.detail.trim()||(o.showToast({title:"请填写详细描述",icon:"none"}),!1):(o.showToast({title:"请填写项目名称",icon:"none"}),!1)},handleError:function(e){o.showToast({title:"发布失败: ".concat(e||"未知错误"),icon:"none",duration:3e3})},handleClose:function(){o.reLaunch({url:"/pages/post-home/post-home"})},handlePublish:function(){var t=this;return(0,u.default)(a.default.mark((function n(){var r,i;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t,t.validateForm()){n.next=3;break}return n.abrupt("return");case 3:return n.prev=3,n.next=6,e.callFunction({name:"art_add_row",data:{detail:r.formData,picurls:r.picurls,hType:"coper"}});case 6:i=n.sent,console.log(i),i?(o.showToast({title:"发布成功",icon:"success"}),setTimeout((function(){return o.navigateBack()}),1500)):t.handleError(i.result.message),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](3),t.handleError(n.t0.message);case 14:case"end":return n.stop()}}),n,null,[[3,11]])})))()}}};t.default=l}).call(this,n("861b")["uniCloud"],n("df3c")["default"])}},[["5844","common/runtime","common/vendor"]]]);