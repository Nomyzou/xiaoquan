(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"06d3":function(e,o,t){"use strict";t.r(o);var n=t("65d3"),i=t("893f");for(var s in i)["default"].indexOf(s)<0&&function(e){t.d(o,e,(function(){return i[e]}))}(s);t("a9da");var c=t("828b"),r=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,"1b4581da",null,!1,n["a"],void 0);o["default"]=r.exports},"1b6d":function(e,o,t){},"65d3":function(e,o,t){"use strict";t.d(o,"b",(function(){return i})),t.d(o,"c",(function(){return s})),t.d(o,"a",(function(){return n}));var n={uSearch:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui/components/u-search/u-search")]).then(t.bind(null,"c745"))},uPopup:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui/components/u-popup/u-popup")]).then(t.bind(null,"7ddf"))},uButton:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui/components/u-button/u-button")]).then(t.bind(null,"6181"))},uIcon:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui/components/u-icon/u-icon")]).then(t.bind(null,"899d"))},Newsbox:function(){return t.e("components/Newsbox/Newsbox").then(t.bind(null,"8776"))}},i=function(){var e=this,o=e.$createElement;e._self._c;e._isMounted||(e.e0=function(o){e.showSchoolPopup=!1},e.e1=function(o){e.showSchoolPopup=!1})},s=[]},"893f":function(e,o,t){"use strict";t.r(o);var n=t("fa1e"),i=t.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){t.d(o,e,(function(){return n[e]}))}(s);o["default"]=i.a},a9da:function(e,o,t){"use strict";var n=t("1b6d"),i=t.n(n);i.a},b153:function(e,o,t){"use strict";(function(e,o){var n=t("47a9");t("f891"),t("861b");n(t("3240"));var i=n(t("06d3"));e.__webpack_require_UNI_MP_PLUGIN__=t,o(i.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])},fa1e:function(e,o,t){"use strict";(function(e,t,n){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i={data:function(){return{searchKeyword:"",showLocationPopup:!1,showSchoolPopup:!1,selectedProvince:"",selectedSchool:"",currentSchool:"",userLocation:null,provinces:["北京","上海","广东","江苏","浙江","四川","湖北","陕西","山东","福建"],currentUniversities:[],schoolOptions:[],universitiesByProvince:{"北京":["北京大学","清华大学","中国人民大学","北京师范大学"],"上海":["复旦大学","上海交通大学","同济大学","华东师范大学"],"广东":["中山大学","华南理工大学","暨南大学","华南师范大学"]},showPop:!1,selectedIndex:-1,selectedIndex1:-1,userInfo:{nickname:"用户"+Math.floor(1e4*Math.random()),avatar:"https://mp-f64dc8e9-0824-4c0c-bbb7-13f1287eb6e2.cdn.bspapp.com/cloudstorage/one.png",openid:"",token:""},tabName:["找搭子","闲置","讨论","兼职","科研","社团"],tabName1:["项目支持","推广成果","科研合作","广告","讨论","兼职"],activeName:"",listArr:["1","2","3"],listArr_inner:[],listArr_outer:[],title:"Hello",type:["samepeople","unused","topic"],head:["寻找一起冲浪的小伙伴","用了四年的充电宝","有没有推荐的强化学习视频"]}},onLoad:function(){var o=this;this.getData(),console.log("dataget",this.listArr),e.checkSession({success:function(){console.log("session_key 未过期");var t=e.getStorageSync("token");t?o.getUserInfo(t):(console.log("未找到本地 token，需要重新登录"),o.showPop=!0)},fail:function(){console.log("session_key 已过期，需要重新登录"),o.showPop=!0}})},methods:{openPop:function(){console.log("打开")},closePop:function(){this.showPop=!1},handleLogin:function(){var o=this;e.login({success:function(i){i.code?(console.log("登录凭证：",i.code),t.callFunction({name:"registerUser",data:{code:i.code},success:function(i){0===i.result.code?(e.setStorageSync("token",i.result.token),t.callFunction({name:"getUserInfo",data:{token:i.result.token},success:function(e){0===e.result.code?(o.userInfo=e.result.data,o.$globalData.userInfo={nickname:e.result.data.nickname,avatar:e.result.data.avatar,token:i.result.token},n.showToast({title:"登录成功",icon:"success"}),o.closePop()):console.error("获取用户信息失败：",e.result.message)},fail:function(e){console.error("获取用户信息失败：",e)}})):(console.error("登录失败：",i.result.message),n.showToast({title:"登录失败",icon:"none"}))},fail:function(e){console.error("请求失败：",e),n.showToast({title:"请求失败",icon:"none"})}})):(console.error("登录失败：",i.errMsg),n.showToast({title:"登录失败",icon:"none"}))},fail:function(e){console.error("登录失败：",e),n.showToast({title:"登录失败",icon:"none"})}})},selectItem:function(e){this.selectedIndex=e;this.listArr_outer=this.listArr.filter((function(e){return void 0!==e.situation&&null!==e.situation&&"outer"===e.situation})),this.selectedIndex=e,console.log(e),console.log(this.tabName[e]),this.listArr_outer=this.listArr_outer.filter((function(o){return o.type===e})),console.log(this.listArr_inner)},selectItem_inner:function(e){var o=this;this.listArr_inner=this.listArr.filter((function(e){return void 0!==e.situation&&null!==e.situation&&"inner"===e.situation})),this.selectedIndex1=e,console.log(e),console.log(o.tabName[e]),this.listArr_inner=this.listArr_inner.filter((function(t){return t.type===o.tabName[e]})),console.log(this.listArr_inner)},getUserInfo:function(e){t.callFunction({name:"getUserInfo",data:{token:e},success:function(e){0===e.result.code?console.log("业务数据：",e.result.data):console.error("获取业务数据失败：",e.result.message)},fail:function(e){console.error("请求失败：",e)}})},getData:function(){var e=this;t.callFunction({name:"art_get_all"}).then((function(o){console.log("获取数据库数据",o),e.listArr=o.result.data,e.listArr_inner=e.listArr.filter((function(e){return void 0!==e.situation&&null!==e.situation&&"inner"===e.situation})),e.listArr_outer=e.listArr.filter((function(e){return void 0!==e.situation&&null!==e.situation&&"outer"===e.situation})),console.log(e.listArr_outer)}))},gotoDetail:function(e){var o="",i="";"tz"===e.hType?"inner"===e.situation?(i="discussion-inner",o="/pages/discussion-detail/discussion-detail"):"outer"===e.situation&&(i="discussion-outer",o="/pages/discussion-detail/discussion-detail"):o="dz"===e.hType?"/pages/companion-detail/companion-detail":"xz"===e.hType?"/pages/auction-detail/auction-detail":"/pages/detail/detail",i?t.callFunction({name:"getDiscussionDetail",data:{tableName:i,id:e._id},success:function(e){if(0===e.result.code){var t=e.result.data["0"];console.log("detailData",t),n.navigateTo({url:o,success:function(e){e.eventChannel.emit("sendData",{ID_token:t.ID_token,id:t._id,head:t.head,detail:t.detail,answer:t.answers||[]})}})}else console.error("获取讨论详情失败：",e.result.message)},fail:function(e){console.error("请求失败：",e)}}):n.navigateTo({url:o,success:function(o){o.eventChannel.emit("sendData",{head:e.head,detail:e.detail})}})},handleSearch:function(){if(this.searchKeyword.trim()){var e=this.searchKeyword.toLowerCase();this.listArr_inner=this.listArr.filter((function(o){return"inner"===o.situation&&(o.head.toLowerCase().includes(e)||o.detail.toLowerCase().includes(e))})),this.listArr_outer=this.listArr.filter((function(o){return"outer"===o.situation&&(o.head.toLowerCase().includes(e)||o.detail.toLowerCase().includes(e))}))}else this.getData()},selectProvince:function(e){this.selectedProvince=e,this.currentUniversities=this.universitiesByProvince[e]||[]},selectUniversity:function(e){this.selectedSchool=e,this.currentSchool=e,this.showSchoolPopup=!1},handleSchoolSelect:function(){this.showLocationPopup=!0},handleLocationReject:function(){this.showLocationPopup=!1,this.showSchoolPopup=!0},handleLocationAccept:function(){var o=this;this.showLocationPopup=!1,e.getLocation({type:"gcj02",success:function(e){console.log("获取位置成功：",e),o.userLocation=e,console.log("纬度：",e.latitude),console.log("经度：",e.longitude),console.log("速度：",e.speed),console.log("精度：",e.accuracy),console.log("高度：",e.altitude),console.log("垂直精度：",e.verticalAccuracy),console.log("水平精度：",e.horizontalAccuracy),o.recommendSchoolByLocation(e)},fail:function(e){console.error("获取位置失败：",e),n.showToast({title:"获取位置失败",icon:"none"})},complete:function(){o.showSchoolPopup=!0}})},recommendSchoolByLocation:function(e){console.log("根据位置推荐学校：",e)}}};o.default=i}).call(this,t("3223")["default"],t("861b")["uniCloud"],t("df3c")["default"])}},[["b153","common/runtime","common/vendor"]]]);